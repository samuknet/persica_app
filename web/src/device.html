<head>
<script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>

<style>
    body {
        font-family: arial;
    }
    #output {
        width: 100px;
        height: 100px;
        border: 1px solid black;
        transition: background-color 0.5s ease;
    }
</style>

</head>
<body>
<h1>Linux Device Emulator</h1>
<div id="didF">

</div>

Register Cmd: <input type="text" id="cmdF" />

Register variable name: <input type="text" id="varNameF" />
Register variable value: <input type="text" id="varValueF" />

<div id="output">

</div>
<audio src="/song" id="audio" />
<script>
    var audio = document.getElementById('audio');

    // oscillator.start(context.currentTime);
    function out(msg) {
        document.getElementById('output').style.backgroundColor = msg;
    }

    var did = 500;
    
    var cmdF = document.getElementById('cmdF');
    var varNameF = document.getElementById('varNameF');
    var varValueF = document.getElementById('varValueF');

    var didF = document.getElementById('didF');

    didF.innerHTML = 'DID: ' + did;

    var socket = io('/device?did=' + did);
    socket.on('cmd', function (data) {
        out(data.cmd);
    });
    
     cmdF.addEventListener('keydown', function (evt) {
        if (evt.keyCode === 13) {
            socket.emit('device-register-cmd', {cmd: cmdF.value});
        }
    });

     varValueF.addEventListener('keydown', function (evt) {
        if (evt.keyCode === 13) {
            socket.emit('device-updateVariable', {handle: varNameF.value, value : varValueF.value})

        };
     });

    

    socket.emit('device-register-cmd', {cmd: 'play'});
    socket.on('cmd', function (data) {
        console.log('hi');
        if (data.cmd === 'play') {
            audio.play();
        };
    });

</script>
</body>
